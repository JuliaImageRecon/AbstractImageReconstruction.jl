<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Radon Data · AbstractImageReconstruction.jl</title><meta name="title" content="Radon Data · AbstractImageReconstruction.jl"/><meta property="og:title" content="Radon Data · AbstractImageReconstruction.jl"/><meta property="twitter:title" content="Radon Data · AbstractImageReconstruction.jl"/><meta name="description" content="Documentation for AbstractImageReconstruction.jl."/><meta property="og:description" content="Documentation for AbstractImageReconstruction.jl."/><meta property="twitter:description" content="Documentation for AbstractImageReconstruction.jl."/><meta property="og:url" content="https://github.com/JuliaImageRecon/AbstractImageReconstruction.jl/generated/example/0_radon_data/"/><meta property="twitter:url" content="https://github.com/JuliaImageRecon/AbstractImageReconstruction.jl/generated/example/0_radon_data/"/><link rel="canonical" href="https://github.com/JuliaImageRecon/AbstractImageReconstruction.jl/generated/example/0_radon_data/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">AbstractImageReconstruction.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Example: Radon Reconstruction Package</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../example_intro/">Introduction</a></li><li class="is-active"><a class="tocitem" href>Radon Data</a><ul class="internal"><li><a class="tocitem" href="#Background"><span>Background</span></a></li><li><a class="tocitem" href="#2D-Phantom"><span>2D Phantom</span></a></li><li><a class="tocitem" href="#3D-Pnantom"><span>3D Pnantom</span></a></li><li><a class="tocitem" href="#Time-Series-of-3D-Phantoms"><span>Time Series of 3D Phantoms</span></a></li></ul></li><li><a class="tocitem" href="../1_interface/">Interface</a></li><li><a class="tocitem" href="../2_direct/">Direct Reconstruction</a></li><li><a class="tocitem" href="../3_direct_result/">Direct Reconstruction Result</a></li><li><a class="tocitem" href="../4_iterative/">Iterative Reconstruction</a></li><li><a class="tocitem" href="../5_iterative_result/">Iterative Reconstruction Result</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">How to</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../howto/serialization/">Serialization</a></li><li><a class="tocitem" href="../../howto/caching/">Caching</a></li><li><a class="tocitem" href="../../howto/observables/">Observables</a></li><li><a class="tocitem" href="../../howto/multi_threading/">Multi-Threading</a></li></ul></li><li><a class="tocitem" href="../../../API/api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Example: Radon Reconstruction Package</a></li><li class="is-active"><a href>Radon Data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Radon Data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaImageRecon/AbstractImageReconstruction.jl/blob/main/docs/src/literate/example/0_radon_data.jl#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Radon-Data"><a class="docs-heading-anchor" href="#Radon-Data">Radon Data</a><a id="Radon-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Radon-Data" title="Permalink"></a></h1><p>In this example we will set up our radon data using RadonKA.jl, ImagePhantoms.jl and ImageGeoms.jl. We will start with simple 2D images and their sinograms and continue with a time series of 3D images and sinograms.</p><h2 id="Background"><a class="docs-heading-anchor" href="#Background">Background</a><a id="Background-1"></a><a class="docs-heading-anchor-permalink" href="#Background" title="Permalink"></a></h2><p>The Radon transform is an integral transform that projects the values of a function(or a phantom) along straight lines onto a detector. These projections are recorded for a number of different angles and form the so-called sinogram. The Radon transform and its adjoint form the mathematical basis for computed tomography (CT) and other imaging modalities such as single photon emission computed tomography (SPECT) and positron emission tomography (PET).</p><h2 id="2D-Phantom"><a class="docs-heading-anchor" href="#2D-Phantom">2D Phantom</a><a id="2D-Phantom-1"></a><a class="docs-heading-anchor-permalink" href="#2D-Phantom" title="Permalink"></a></h2><p>We will use a simple Shepp-Logan phantom to generate our Radon data. The phantom is a standard test image for medical imaging and consists of a number of ellipses with different intensities. It can be generated using ImagePhantoms.jl and ImageGeoms.jl. as follows:</p><pre><code class="language-julia hljs">using ImagePhantoms, ImageGeoms
N = 256
image = shepp_logan(N, SheppLoganToft())
size(image)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(256, 256)</code></pre><p>This produces a 256x256 image of a Shepp-Logan phantom. Next, we will generate the Radon data using <code>radon</code> from RadonKA.jl. The arguments of this function are the image or phantom to be transformed, the angles at which the projections are taken, and the used geometry of the system. For this example we will use the default parallel circle geometry. For more details, we refer to the RadonKA.jl documentation. We will use 256 angles for the projections, between 0 and π.</p><pre><code class="language-julia hljs">using RadonKA
angles = collect(range(0, π, 256))
sinogram = Array(RadonKA.radon(image, angles))
size(sinogram)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(255, 256)</code></pre><p>To visualize our progress so far, we will use CairoMakie.jl and a small helper function:</p><pre><code class="language-julia hljs">using CairoMakie
function plot_image(figPos, img; title = &quot;&quot;, width = 150, height = 150)
  ax = CairoMakie.Axis(figPos[1, 1]; yreversed=true, title, width, height)
  hidedecorations!(ax)
  hm = heatmap!(ax, img)
  Colorbar(figPos[1, 2], hm)
end
fig = Figure()
plot_image(fig[1,1], image, title = &quot;Image&quot;)
plot_image(fig[1,2], sinogram, title = &quot;Sinogram&quot;)
resize_to_layout!(fig)
fig</code></pre><img src="94fbae60.png" alt="Example block output"/><h2 id="3D-Pnantom"><a class="docs-heading-anchor" href="#3D-Pnantom">3D Pnantom</a><a id="3D-Pnantom-1"></a><a class="docs-heading-anchor-permalink" href="#3D-Pnantom" title="Permalink"></a></h2><p>RadonKA.jl also supports 3D Radon transforms. The first two dimensions are interpreted as the XY plane where the transform applied and the last dimensions is the rotational axis z of the projections. For that we need to create a 3D Shepp-Logan phantom. First we retrieve the parameters of the ellipsoids of the Shepp-Logan phantom:</p><pre><code class="language-julia hljs">shape = (64, 64, 64)
params = map(collect, ellipsoid_parameters(; fovs = shape));</code></pre><p>We then scale the intensities of the ellipsoids to [0.0, ..., 1.0]:</p><pre><code class="language-julia hljs">toft_settings = [1.0, -0.8, -0.2, -0.2, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
for idx in eachindex(toft_settings)
  params[idx][10] = toft_settings[idx]
end</code></pre><p>Finally, we create the 3D Shepp-Logan phantom by defining and sampling our image geometry:</p><pre><code class="language-julia hljs">ob = ellipsoid(map(Tuple, params))
ig = ImageGeom(;dims = shape)
image = phantom(axes(ig)..., ob)
size(image)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(64, 64, 64)</code></pre><p>Now we can compute the 3D Radon transform of our phantom:</p><pre><code class="language-julia hljs">sinogram = Array(RadonKA.radon(image, angles))
size(sinogram)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(63, 256, 64)</code></pre><p>Let&#39;s visualize the 3D Radon data:</p><pre><code class="language-julia hljs">fig = Figure()
plot_image(fig[1,1], reverse(image[26,:,:]), title = &quot;Slice YZ at z=26&quot;)
plot_image(fig[1,2], image[:,40,:], title = &quot;Slice XZ at y=40&quot;)
plot_image(fig[2,1], reverse(image[:, :, 24]), title = &quot;Slice XY at z=24&quot;)
plot_image(fig[2,2], reverse(sinogram[:,:,24]), title = &quot;Sinogram at z=24&quot;)
plot_image(fig[3,1], reverse(image[:, :,16]), title = &quot;Slice XY at z=16&quot;)
plot_image(fig[3,2], reverse(sinogram[:,:,16]), title = &quot;Sinogram at z=16&quot;)
resize_to_layout!(fig)
fig</code></pre><img src="bff4c7e5.png" alt="Example block output"/><h2 id="Time-Series-of-3D-Phantoms"><a class="docs-heading-anchor" href="#Time-Series-of-3D-Phantoms">Time Series of 3D Phantoms</a><a id="Time-Series-of-3D-Phantoms-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Series-of-3D-Phantoms" title="Permalink"></a></h2><p>Lastly, we want to add a time dimension to our 3D phantom. For our example we will increase the intensity of the third ellipsoid every time step or frame.</p><pre><code class="language-julia hljs">images = similar(image, size(image)..., 5)
sinograms = similar(sinogram, size(sinogram)..., 5)
for (i, intensity) in enumerate(range(params[3][end], 0.3, 5))
  params[3][end] = intensity
  local ob = ellipsoid(map(Tuple, params))
  local ig = ImageGeom(;dims = shape)
  images[:, :, :, i] = phantom(axes(ig)..., ob)
  sinograms[:, :, :, i] = Array(RadonKA.radon(images[:, :, :, i], angles))
end
size(sinograms)

fig = Figure()
for i = 1:5
  plot_image(fig[i,1], reverse(images[:, :, 24, i]))
  plot_image(fig[i,2], sinograms[:, :, 24, i])
end
resize_to_layout!(fig)
fig</code></pre><img src="0cd0e5c8.png" alt="Example block output"/><p>The goal of our reconstruction package is now to recover an approximation of the time-series 3D phantoms from a given time-series of sinograms. In the next section we will introduce our class hierarchies and explore the API of AbstractImageReconstruction.jl.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../../example_intro/">« Introduction</a><a class="docs-footer-nextpage" href="../1_interface/">Interface »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Thursday 12 December 2024 15:11">Thursday 12 December 2024</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
